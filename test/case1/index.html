<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
    <script src="../../dist/messenger.dist.js" ></script>
</head>
<body>
    <script>
        var callself=()=>{
            messenger.post('askSelf', 5).then((result)=>{
                console.warn('got-self!', result)
            })
        }
        messenger.subscribe('askSelf', (num)=>{
            return 'ooooo'+num
        })
        ////////////////////
        var call=()=>{
            messenger.post('asklevel3', 11,22,true,[]).then((result, msgInfo)=>{
                console.warn('got!', result, msgInfo.count)
            })
            messenger.post('asklevel1', 11,22,true,[]).then((result, msgInfo)=>{
                console.warn('got!', result, msgInfo.count)
            })
            messenger.post('askAndReceiveTwice', 11,22,true,[]).then((result, msgInfo)=>{
                console.warn('should only receive twice!', msgInfo.count, result)
                if(msgInfo.count >= 2)msgInfo.stopReceive();//stop receive
            })
        }
        messenger.subscribe('askTop', ()=>{
            return 'ooooooooooooo'
        })
        messenger.subscribe('askfromlevel2', (num)=>{
            return num*2
        })
    </script>

    <iframe id="frame1" src="./child-level1.html" ></iframe>
    <iframe id="frame2" src="./child-level1.html" ></iframe>
    <hr>
    <button onclick="call()">call</button>
    <button onclick="callself()">call-self</button>

</body>
</html>